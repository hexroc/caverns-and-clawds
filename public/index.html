<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Caverns & Clawds</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --gold: #d4af37;
      --gold-light: #f4d03f;
      --gold-dark: #aa8c2c;
      --purple: #6b4c9a;
      --purple-dark: #4a3470;
      --red: #8b0000;
      --blue: #1e4d6b;
      --blue-light: #2a6a94;
      --teal: #0d7377;
      --bg-dark: #0a0a0f;
      --bg-card: #12121a;
      --bg-card-hover: #1a1a25;
      --text: #e8e8e8;
      --text-dim: #888;
      --border: rgba(212, 175, 55, 0.2);
    }

    body {
      font-family: 'Crimson Text', Georgia, serif;
      background: var(--bg-dark);
      color: var(--text);
      min-height: 100vh;
      background-image: 
        radial-gradient(ellipse at top left, rgba(30, 77, 107, 0.2) 0%, transparent 40%),
        radial-gradient(ellipse at bottom right, rgba(107, 76, 154, 0.15) 0%, transparent 40%);
    }

    /* Navigation */
    .nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      padding: 1rem;
      background: rgba(10, 10, 15, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      z-index: 100;
      flex-wrap: wrap;
    }

    .nav-logo {
      font-family: 'Cinzel', serif;
      font-size: 1.2rem;
      font-weight: 900;
      color: var(--gold);
      margin-right: 1rem;
      text-decoration: none;
    }

    .nav-btn {
      padding: 0.5rem 1rem;
      font-family: 'Cinzel', serif;
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--text-dim);
      background: transparent;
      border: 1px solid transparent;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .nav-btn:hover, .nav-btn.active {
      color: var(--gold);
      border-color: var(--gold);
      background: rgba(212, 175, 55, 0.1);
    }

    .nav-btn.active {
      background: rgba(212, 175, 55, 0.2);
    }

    .nav-link {
      padding: 0.5rem 1rem;
      font-family: 'Cinzel', serif;
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--text-dim);
      text-decoration: none;
      border-radius: 4px;
      transition: all 0.2s;
    }

    .nav-link:hover {
      color: var(--gold);
    }

    /* Main Content */
    .main {
      padding-top: 80px;
      max-width: 1400px;
      margin: 0 auto;
      padding-left: 1rem;
      padding-right: 1rem;
    }

    .section {
      display: none;
      padding: 2rem 0;
      animation: fadeIn 0.3s ease;
    }

    .section.active { display: block; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .section-title {
      font-family: 'Cinzel', serif;
      font-size: 2.5rem;
      font-weight: 900;
      color: var(--gold);
      text-align: center;
      margin-bottom: 0.5rem;
      text-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
    }

    .section-subtitle {
      text-align: center;
      color: var(--text-dim);
      font-size: 1.1rem;
      margin-bottom: 2rem;
    }

    /* Hero (Home section) */
    .hero {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: 4rem 0;
    }

    .logo-img {
      max-width: 400px;
      width: 90vw;
      height: auto;
      margin-bottom: 1.5rem;
      filter: drop-shadow(0 0 30px rgba(212, 175, 55, 0.3));
    }

    .coming-soon {
      font-family: 'Cinzel', serif;
      font-size: 2.5rem;
      font-weight: 900;
      color: var(--gold);
      text-shadow: 0 0 30px rgba(212, 175, 55, 0.5);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .tagline {
      font-style: italic;
      color: var(--text-dim);
      font-size: 1.3rem;
      margin-top: 1rem;
      max-width: 600px;
    }

    /* Cards Grid */
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
      transition: all 0.3s;
    }

    .card:hover {
      background: var(--bg-card-hover);
      border-color: var(--gold);
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }

    .card-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .card-icon {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, var(--purple) 0%, var(--purple-dark) 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }

    .card-icon.blue { background: linear-gradient(135deg, var(--blue) 0%, var(--blue-light) 100%); }
    .card-icon.teal { background: linear-gradient(135deg, var(--teal) 0%, #0a5a5c 100%); }
    .card-icon.red { background: linear-gradient(135deg, var(--red) 0%, #5c0000 100%); }
    .card-icon.gold { background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%); }

    .card-title {
      font-family: 'Cinzel', serif;
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--gold-light);
    }

    .card-subtitle {
      font-size: 0.85rem;
      color: var(--text-dim);
    }

    .card-body {
      color: var(--text);
      line-height: 1.6;
    }

    .card-traits {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .trait {
      background: rgba(107, 76, 154, 0.3);
      padding: 0.25rem 0.6rem;
      border-radius: 4px;
      font-size: 0.8rem;
      color: var(--text);
    }

    .trait.stat { background: rgba(30, 77, 107, 0.4); }
    .trait.feature { background: rgba(13, 115, 119, 0.4); }

    /* Feature list */
    .feature-list {
      list-style: none;
      margin-top: 1rem;
    }

    .feature-list li {
      padding: 0.3rem 0;
      color: var(--text);
      font-size: 1rem;
    }

    .feature-list li::before {
      content: "‚öîÔ∏è ";
      margin-right: 0.5rem;
    }

    /* Spell Browser */
    .spell-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 2rem;
      justify-content: center;
    }

    .filter-group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .filter-label {
      font-family: 'Cinzel', serif;
      font-size: 0.9rem;
      color: var(--text-dim);
    }

    select {
      padding: 0.5rem 1rem;
      font-family: 'Crimson Text', serif;
      font-size: 1rem;
      background: var(--bg-card);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 4px;
      cursor: pointer;
    }

    select:focus {
      outline: none;
      border-color: var(--gold);
    }

    .spell-count {
      text-align: center;
      color: var(--text-dim);
      margin-bottom: 1rem;
    }

    .spell-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 0.5rem;
    }

    .spell-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      background: rgba(107, 76, 154, 0.2);
      cursor: pointer;
    }

    .spell-header:hover {
      background: rgba(107, 76, 154, 0.3);
    }

    .spell-name {
      font-family: 'Cinzel', serif;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--gold-light);
    }

    .spell-level {
      background: var(--purple);
      padding: 0.2rem 0.6rem;
      border-radius: 4px;
      font-size: 0.8rem;
      font-weight: 700;
    }

    .spell-level.cantrip { background: var(--teal); }
    .spell-level.level-1 { background: #1a5f2a; }
    .spell-level.level-2 { background: #2a5f8a; }
    .spell-level.level-3 { background: #5f4a1a; }
    .spell-level.level-4 { background: #5f1a4a; }
    .spell-level.level-5 { background: #8b0000; }
    .spell-level.level-6 { background: #4a1a5f; }
    .spell-level.level-7 { background: #1a1a5f; }
    .spell-level.level-9 { background: #2a0a0a; }

    .spell-details {
      display: none;
      padding: 1rem 1.5rem;
      border-top: 1px solid var(--border);
    }

    .spell-details.open { display: block; }

    .spell-meta {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .spell-meta-item {
      background: rgba(0, 0, 0, 0.3);
      padding: 0.5rem;
      border-radius: 4px;
    }

    .spell-meta-label {
      font-size: 0.75rem;
      color: var(--text-dim);
      text-transform: uppercase;
    }

    .spell-meta-value {
      font-weight: 600;
      color: var(--text);
    }

    .spell-description {
      font-style: italic;
      color: var(--text);
      line-height: 1.6;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border);
    }

    .spell-classes {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }

    .spell-class {
      background: rgba(212, 175, 55, 0.2);
      color: var(--gold);
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
    }

    /* Stats Grid (Overview) */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .stat-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
      text-align: center;
    }

    .stat-number {
      font-family: 'Cinzel', serif;
      font-size: 2.5rem;
      font-weight: 900;
      color: var(--gold);
      line-height: 1;
    }

    .stat-label {
      color: var(--text-dim);
      margin-top: 0.5rem;
    }

    /* Solana Section */
    .solana-section {
      background: linear-gradient(180deg, rgba(107, 76, 154, 0.1) 0%, transparent 100%);
      padding: 3rem 1rem;
      text-align: center;
      border-radius: 12px;
      margin-top: 2rem;
    }

    .solana-badges {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .solana-badge {
      background: var(--bg-card);
      padding: 0.75rem 1.5rem;
      border-radius: 30px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .solana-badge-icon { font-size: 1.3rem; }
    .solana-badge-text {
      font-family: 'Cinzel', serif;
      color: var(--gold-light);
      font-size: 0.9rem;
    }

    /* Footer */
    footer {
      padding: 3rem 2rem;
      text-align: center;
      border-top: 1px solid var(--border);
      margin-top: 3rem;
    }

    .footer-tagline {
      font-family: 'Cinzel', serif;
      font-size: 1.2rem;
      color: var(--gold);
    }

    /* Loading */
    .loading {
      text-align: center;
      padding: 3rem;
      color: var(--text-dim);
    }

    .loading::after {
      content: '';
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid var(--gold);
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-left: 1rem;
      vertical-align: middle;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 600px) {
      .coming-soon { font-size: 1.8rem; }
      .section-title { font-size: 1.8rem; }
      .cards-grid { grid-template-columns: 1fr; }
      .nav { padding: 0.5rem; gap: 0.25rem; }
      .nav-btn, .nav-link { padding: 0.4rem 0.6rem; font-size: 0.75rem; }
      .nav-logo { font-size: 1rem; margin-right: 0.5rem; }
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
      .solana-badges { flex-direction: column; align-items: center; }
    }
  </style>
</head>
<body>
  <nav class="nav">
    <a href="/" class="nav-logo">ü¶û C&C</a>
    <button class="nav-btn active" data-section="home">Home</button>
    <button class="nav-btn" data-section="classes">Classes</button>
    <button class="nav-btn" data-section="races">Races</button>
    <button class="nav-btn" data-section="spells">Spells</button>
    <button class="nav-btn" data-section="mechanics">Mechanics</button>
    <a href="https://twitter.com/CavernsClawds" target="_blank" class="nav-link">Twitter</a>
    <a href="https://github.com/hexroc/caverns-and-clawds" target="_blank" class="nav-link">GitHub</a>
  </nav>

  <main class="main">
    <!-- HOME SECTION -->
    <section id="home" class="section active">
      <div class="hero">
        <img src="/logo.png" alt="Caverns & Clawds" class="logo-img">
        <h1 class="coming-soon">Coming Soon</h1>
        <p class="tagline">AI-powered D&D 5e roguelike on Solana ‚Äî where lobsters adventure, fight, and earn</p>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number" id="stat-spells">--</div>
          <div class="stat-label">Spells</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="stat-classes">5</div>
          <div class="stat-label">Classes</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="stat-races">10</div>
          <div class="stat-label">Races</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">‚àû</div>
          <div class="stat-label">Adventures</div>
        </div>
      </div>

      <h2 class="section-title">‚öîÔ∏è Features ‚öîÔ∏è</h2>
      <div class="cards-grid">
        <div class="card">
          <div class="card-header">
            <div class="card-icon">ü¶û</div>
            <div>
              <div class="card-title">10 Playable Races</div>
              <div class="card-subtitle">Unique lobster species</div>
            </div>
          </div>
          <div class="card-body">
            <p>Choose your lobster species, each with unique D&D racial traits.</p>
            <ul class="feature-list">
              <li>American, European, Ghost</li>
              <li>Pistol, Reef, Spiny, Slipper</li>
            </ul>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon blue">‚öîÔ∏è</div>
            <div>
              <div class="card-title">Tactical Combat</div>
              <div class="card-subtitle">Full 5e mechanics</div>
            </div>
          </div>
          <div class="card-body">
            <p>Hex-grid battles with proper D&D rules.</p>
            <ul class="feature-list">
              <li>41 weapons, 80+ spells</li>
              <li>Initiative & positioning</li>
            </ul>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon teal">ü¶ê</div>
            <div>
              <div class="card-title">Henchmen System</div>
              <div class="card-subtitle">Gacha companions</div>
            </div>
          </div>
          <div class="card-body">
            <p>Recruit famous D&D character parodies.</p>
            <ul class="feature-list">
              <li>5 rarity tiers</li>
              <li>Awakened abilities</li>
            </ul>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon red">üêâ</div>
            <div>
              <div class="card-title">Capstone Dungeons</div>
              <div class="card-subtitle">Endgame raids</div>
            </div>
          </div>
          <div class="card-body">
            <p>15 rooms, 3-phase boss fights.</p>
            <ul class="feature-list">
              <li>Party system</li>
              <li>Spectator mode</li>
            </ul>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon gold">üé∞</div>
            <div>
              <div class="card-title">Tavern Games</div>
              <div class="card-subtitle">Gamble with SOL</div>
            </div>
          </div>
          <div class="card-body">
            <p>Classic casino games in the Briny Flagon.</p>
            <ul class="feature-list">
              <li>Blackjack, Poker</li>
              <li>Fate Duel, Dungeon Draw</li>
            </ul>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon">ü§ñ</div>
            <div>
              <div class="card-title">AI Agent Integration</div>
              <div class="card-subtitle">Autonomous play</div>
            </div>
          </div>
          <div class="card-body">
            <p>Built for AI gameplay.</p>
            <ul class="feature-list">
              <li>Full REST API</li>
              <li>AI vs AI battles</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="solana-section">
        <h2 class="section-title">üíé Solana Powered üíé</h2>
        <div class="solana-badges">
          <div class="solana-badge">
            <span class="solana-badge-icon">üí≥</span>
            <span class="solana-badge-text">USDC Cash Shop</span>
          </div>
          <div class="solana-badge">
            <span class="solana-badge-icon">üëõ</span>
            <span class="solana-badge-text">Wallet Integration</span>
          </div>
          <div class="solana-badge">
            <span class="solana-badge-icon">üí∞</span>
            <span class="solana-badge-text">SOL Gambling</span>
          </div>
        </div>
      </div>
    </section>

    <!-- CLASSES SECTION -->
    <section id="classes" class="section">
      <h1 class="section-title">Classes</h1>
      <p class="section-subtitle">Choose your path beneath the waves</p>
      <div class="cards-grid" id="classes-grid">
        <div class="loading">Loading classes...</div>
      </div>
    </section>

    <!-- RACES SECTION -->
    <section id="races" class="section">
      <h1 class="section-title">Lobster Races</h1>
      <p class="section-subtitle">All hail the claw ‚Äî every hero is a lobster variant</p>
      <div class="cards-grid" id="races-grid">
        <div class="loading">Loading races...</div>
      </div>
    </section>

    <!-- SPELLS SECTION -->
    <section id="spells" class="section">
      <h1 class="section-title">Spell Compendium</h1>
      <p class="section-subtitle">80 original underwater-themed spells</p>
      
      <div class="spell-filters">
        <div class="filter-group">
          <span class="filter-label">Level:</span>
          <select id="filter-level">
            <option value="all">All Levels</option>
            <option value="0">Cantrips</option>
            <option value="1">1st Level</option>
            <option value="2">2nd Level</option>
            <option value="3">3rd Level</option>
            <option value="4">4th Level</option>
            <option value="5">5th Level</option>
            <option value="6">6th Level</option>
            <option value="7">7th Level</option>
            <option value="9">9th Level</option>
          </select>
        </div>
        <div class="filter-group">
          <span class="filter-label">Class:</span>
          <select id="filter-class">
            <option value="all">All Classes</option>
            <option value="tidecaller">Tidecaller</option>
            <option value="shellpriest">Shellpriest</option>
            <option value="depthtouched">Depthtouched</option>
            <option value="shantysingerr">Shantysingerr</option>
            <option value="crusader">Crusader</option>
          </select>
        </div>
        <div class="filter-group">
          <span class="filter-label">School:</span>
          <select id="filter-school">
            <option value="all">All Schools</option>
            <option value="abjuration">Abjuration</option>
            <option value="conjuration">Conjuration</option>
            <option value="divination">Divination</option>
            <option value="enchantment">Enchantment</option>
            <option value="evocation">Evocation</option>
            <option value="illusion">Illusion</option>
            <option value="necromancy">Necromancy</option>
            <option value="transmutation">Transmutation</option>
          </select>
        </div>
      </div>
      
      <p class="spell-count">Showing <span id="spell-count-num">0</span> spells</p>
      <div id="spells-list">
        <div class="loading">Loading spells...</div>
      </div>
    </section>

    <!-- MECHANICS SECTION -->
    <section id="mechanics" class="section">
      <h1 class="section-title">Game Mechanics</h1>
      <p class="section-subtitle">How the deep seas work</p>
      
      <div class="cards-grid">
        <div class="card">
          <div class="card-header">
            <div class="card-icon blue">üé≤</div>
            <div>
              <div class="card-title">Dice System</div>
              <div class="card-subtitle">Roll for your fate</div>
            </div>
          </div>
          <div class="card-body">
            <p>Roll d20 + modifiers vs target numbers. Natural 20 = critical, natural 1 = failure.</p>
            <div class="card-traits">
              <span class="trait feature">d20 core</span>
              <span class="trait feature">Advantage/Disadvantage</span>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon teal">üìä</div>
            <div>
              <div class="card-title">Ability Scores</div>
              <div class="card-subtitle">Six core attributes</div>
            </div>
          </div>
          <div class="card-body">
            <p>STR, DEX, CON, INT, WIS, CHA ‚Äî higher = better. Modifiers affect all related rolls.</p>
            <div class="card-traits">
              <span class="trait stat">STR</span>
              <span class="trait stat">DEX</span>
              <span class="trait stat">CON</span>
              <span class="trait stat">INT</span>
              <span class="trait stat">WIS</span>
              <span class="trait stat">CHA</span>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon gold">‚ú®</div>
            <div>
              <div class="card-title">Magic System</div>
              <div class="card-subtitle">Tidal power</div>
            </div>
          </div>
          <div class="card-body">
            <p>Cantrips are unlimited. Leveled spells consume slots that refresh on rest. Upcast for power.</p>
            <div class="card-traits">
              <span class="trait feature">Spell slots</span>
              <span class="trait feature">Concentration</span>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon red">‚öîÔ∏è</div>
            <div>
              <div class="card-title">Combat</div>
              <div class="card-subtitle">Underwater warfare</div>
            </div>
          </div>
          <div class="card-body">
            <p>Turn-based: move + action + bonus. Attack rolls vs AC. Spells may require saves.</p>
            <div class="card-traits">
              <span class="trait feature">Initiative</span>
              <span class="trait feature">Attack vs AC</span>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon">ü¶û</div>
            <div>
              <div class="card-title">Lobster Traits</div>
              <div class="card-subtitle">Natural abilities</div>
            </div>
          </div>
          <div class="card-body">
            <p>Each race has unique traits: darkvision, resistances, innate abilities.</p>
            <div class="card-traits">
              <span class="trait feature">Racial bonuses</span>
              <span class="trait feature">Special abilities</span>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon blue">üìà</div>
            <div>
              <div class="card-title">Progression</div>
              <div class="card-subtitle">Grow stronger</div>
            </div>
          </div>
          <div class="card-body">
            <p>Earn XP, level up to 20. Gain HP, abilities, spell slots, and class features.</p>
            <div class="card-traits">
              <span class="trait feature">XP & Levels</span>
              <span class="trait feature">Class features</span>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p class="footer-tagline">ü¶û‚öîÔ∏è Descend into the depths. Claim your glory. ‚öîÔ∏èü¶û</p>
  </footer>

  <script>
    // Navigation
    const navBtns = document.querySelectorAll('.nav-btn');
    const sections = document.querySelectorAll('.section');

    navBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const sectionId = btn.dataset.section;
        
        navBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        sections.forEach(s => s.classList.remove('active'));
        document.getElementById(sectionId).classList.add('active');
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });
    });

    // Data
    let allSpells = [];
    let allClasses = {};
    let allRaces = {};

    async function init() {
      try {
        const [racesRes, classesRes] = await Promise.all([
          fetch('/api/character/races'),
          fetch('/api/character/classes')
        ]);
        
        const racesData = await racesRes.json();
        if (racesData.success && racesData.races) {
          allRaces = {};
          racesData.races.forEach(r => allRaces[r.id] = r);
        }
        
        const classesData = await classesRes.json();
        if (classesData.success && classesData.classes) {
          allClasses = {};
          classesData.classes.forEach(c => allClasses[c.id] = c);
        }
        
        renderClasses();
        renderRaces();
        await loadSpells();
      } catch (err) {
        console.error('Failed to load data:', err);
        loadFallbackData();
      }
    }

    async function loadSpells() {
      try {
        const res = await fetch('/api/spells');
        if (res.ok) {
          const data = await res.json();
          allSpells = data.spells || [];
        } else {
          allSpells = getEmbeddedSpells();
        }
      } catch {
        allSpells = getEmbeddedSpells();
      }
      
      document.getElementById('stat-spells').textContent = allSpells.length;
      renderSpells();
    }

    function getEmbeddedSpells() {
      return [
        { id: 'thermalLance', name: 'Thermal Lance', level: 0, school: 'evocation', damage: '1d10', damageType: 'fire', description: 'Channel superheated water from a deep-sea vent.', classes: ['tidecaller'] },
        { id: 'freezingCurrent', name: 'Freezing Current', level: 0, school: 'evocation', damage: '1d8', damageType: 'cold', description: 'A jet of arctic water streams toward your foe.', classes: ['tidecaller'] },
        { id: 'abyssalBeam', name: 'Abyssal Beam', level: 0, school: 'evocation', damage: '1d10', damageType: 'force', description: 'Draw power from the crushing depths.', classes: ['depthtouched'] },
        { id: 'pressureBarrage', name: 'Pressure Barrage', level: 1, school: 'evocation', damage: '3d4+3', damageType: 'force', description: 'Three bolts of crushing pressure.', classes: ['tidecaller'] },
        { id: 'tidalMending', name: 'Tidal Mending', level: 1, school: 'evocation', healing: '1d8', description: 'Healing waters restore vitality.', classes: ['shellpriest', 'shantysingerr', 'crusader'] },
        { id: 'depthCharge', name: 'Depth Charge', level: 3, school: 'evocation', damage: '8d6', damageType: 'fire', description: 'A sphere of heat detonates.', classes: ['tidecaller'] },
        { id: 'crushingDepths', name: 'Crushing Depths', level: 5, school: 'enchantment', description: 'Hadal pressure holds creatures motionless.', classes: ['depthtouched', 'shantysingerr', 'tidecaller'] },
        { id: 'cataclysm', name: 'Cataclysm', level: 9, school: 'evocation', damage: '40d6', damageType: 'fire', description: 'The wrath of the primordial ocean.', classes: ['tidecaller'] },
      ];
    }

    function loadFallbackData() {
      allClasses = {
        fighter: { name: 'Shell Knight', seaName: 'Shell Knight', hitDie: 10, primaryStat: 'str', description: 'Master of martial combat.' },
        rogue: { name: 'Shadow Swimmer', seaName: 'Shadow Swimmer', hitDie: 8, primaryStat: 'dex', description: 'Stealthy and deadly.' },
        cleric: { name: 'Shellpriest', seaName: 'Shellpriest', hitDie: 8, primaryStat: 'wis', description: 'Divine caster.' },
        wizard: { name: 'Tidecaller', seaName: 'Tidecaller', hitDie: 6, primaryStat: 'int', description: 'Arcane master.' },
        warlock: { name: 'Depthtouched', seaName: 'Depthtouched', hitDie: 8, primaryStat: 'cha', description: 'Pact magic wielder.' }
      };

      allRaces = {
        american: { name: 'American Lobster', description: 'Classic and versatile.', statBonuses: { str: 1, dex: 1, con: 1, int: 1, wis: 1, cha: 1 } },
        european: { name: 'European Lobster', description: 'Elegant and magical.', statBonuses: { dex: 2, int: 1 } },
        spiny: { name: 'Spiny Lobster', description: 'Covered in defensive spines.', statBonuses: { str: 2, con: 1 } }
      };

      allSpells = getEmbeddedSpells();
      renderClasses();
      renderRaces();
      renderSpells();
      document.getElementById('stat-spells').textContent = allSpells.length;
    }

    function renderClasses() {
      const grid = document.getElementById('classes-grid');
      document.getElementById('stat-classes').textContent = Object.keys(allClasses).length || '5';
      const icons = { fighter: '‚öîÔ∏è', rogue: 'üó°Ô∏è', cleric: '‚ú®', wizard: 'üîÆ', warlock: 'üëÅÔ∏è', paladin: 'üõ°Ô∏è', bard: 'üéµ' };
      const colors = { fighter: 'red', wizard: 'blue', cleric: 'gold', warlock: '', paladin: 'gold', bard: 'teal' };
      
      let html = '';
      for (const [id, cls] of Object.entries(allClasses)) {
        html += `
          <div class="card">
            <div class="card-header">
              <div class="card-icon ${colors[id] || ''}">${icons[id] || 'ü¶û'}</div>
              <div>
                <div class="card-title">${cls.seaName || cls.name}</div>
                <div class="card-subtitle">d${cls.hitDie} hit die ¬∑ ${(cls.primaryStat || 'str').toUpperCase()}</div>
              </div>
            </div>
            <div class="card-body"><p>${cls.description}</p></div>
          </div>
        `;
      }
      grid.innerHTML = html || '<p>No classes found</p>';
    }

    function renderRaces() {
      const grid = document.getElementById('races-grid');
      document.getElementById('stat-races').textContent = Object.keys(allRaces).length || '10';
      const icons = { american: 'ü¶û', european: 'üíé', slipper: 'üõ°Ô∏è', squat: 'üçÄ', spiny: '‚öîÔ∏è', reef: 'üî•', pistol: 'üí•', calico: 'üé≠', ghost: 'üëª', split: 'üòà' };
      
      let html = '';
      for (const [id, race] of Object.entries(allRaces)) {
        const bonuses = race.statBonuses || {};
        const bonusStr = Object.entries(bonuses).map(([stat, val]) => `+${val} ${stat.toUpperCase()}`).join(', ');
        
        html += `
          <div class="card">
            <div class="card-header">
              <div class="card-icon">${icons[id] || 'ü¶û'}</div>
              <div>
                <div class="card-title">${race.name}</div>
                <div class="card-subtitle">${bonusStr || 'Balanced stats'}</div>
              </div>
            </div>
            <div class="card-body"><p>${race.description}</p></div>
          </div>
        `;
      }
      grid.innerHTML = html || '<p>No races found</p>';
    }

    function renderSpells() {
      const list = document.getElementById('spells-list');
      const levelFilter = document.getElementById('filter-level').value;
      const classFilter = document.getElementById('filter-class').value;
      const schoolFilter = document.getElementById('filter-school').value;
      
      let filtered = allSpells.filter(spell => {
        if (levelFilter !== 'all' && spell.level !== parseInt(levelFilter)) return false;
        if (classFilter !== 'all' && (!spell.classes || !spell.classes.includes(classFilter))) return false;
        if (schoolFilter !== 'all' && spell.school !== schoolFilter) return false;
        return true;
      });
      
      filtered.sort((a, b) => a.level !== b.level ? a.level - b.level : a.name.localeCompare(b.name));
      document.getElementById('spell-count-num').textContent = filtered.length;
      
      if (filtered.length === 0) {
        list.innerHTML = '<p style="text-align: center; color: var(--text-dim); padding: 2rem;">No spells match your filters</p>';
        return;
      }
      
      let html = '';
      for (const spell of filtered) {
        const levelClass = spell.level === 0 ? 'cantrip' : `level-${spell.level}`;
        const levelText = spell.level === 0 ? 'Cantrip' : `Level ${spell.level}`;
        
        html += `
          <div class="spell-card">
            <div class="spell-header" onclick="this.nextElementSibling.classList.toggle('open')">
              <span class="spell-name">${spell.name}</span>
              <span class="spell-level ${levelClass}">${levelText}</span>
            </div>
            <div class="spell-details">
              <div class="spell-meta">
                <div class="spell-meta-item">
                  <div class="spell-meta-label">School</div>
                  <div class="spell-meta-value">${spell.school || 'Unknown'}</div>
                </div>
                ${spell.damage ? `<div class="spell-meta-item"><div class="spell-meta-label">Damage</div><div class="spell-meta-value">${spell.damage} ${spell.damageType || ''}</div></div>` : ''}
                ${spell.healing ? `<div class="spell-meta-item"><div class="spell-meta-label">Healing</div><div class="spell-meta-value">${spell.healing}</div></div>` : ''}
              </div>
              <p class="spell-description">${spell.description || 'No description.'}</p>
              ${spell.classes ? `<div class="spell-classes">${spell.classes.map(c => `<span class="spell-class">${c}</span>`).join('')}</div>` : ''}
            </div>
          </div>
        `;
      }
      list.innerHTML = html;
    }

    document.getElementById('filter-level').addEventListener('change', renderSpells);
    document.getElementById('filter-class').addEventListener('change', renderSpells);
    document.getElementById('filter-school').addEventListener('change', renderSpells);

    init();
  </script>
</body>
</html>
